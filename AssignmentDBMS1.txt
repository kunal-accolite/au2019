
**** Use HR schema wherever tables details are not mentioned ****
-----------------------------------------------------------------------------------------------------------------------------------

1) Display the first name and join date of the employees who joined between 2002 and 2005.

Answer 1: select first_name,hire_date from employees where hire_date between 2002 and 2005;

 

2) Display details of departments in which the maximum salary is more than 10000.

Answer 2: select * from departments where department_id in (select department_id from employees
 	  group by department_id having max(salary)>10000);



3) Display city, departments, number of employee in each department.

Answer 3: create view depts as
	  select d.department_id, d.location_id ,count(e.employee_id)as c from departments as d left join employees as e 
	  on d.department_id=e.department_id group by department_id;

	select l.city , count(depts.department_id) , depts.c from locations as l left join depts
	 on l.location_id=depts.location_id group by l.city;



4) Display Departments where there are more then 5 employees.

Answer 4: select * from departments where department_id in (select department_id from employees
 	  group by department_id having count(employee_id)>5);



5) Create two tables - Color (Color_id,Color_Name) populate it with 5-6 color data
                       Sizes (Size_code,Description) e.g.('M',Medium) populate table with sizes XS,S,M,L,XL,XXL.
   Q) Write Query to Display all possible combinations of color and size.

Answer 5: select * from Color,Sizes;



6) Create a table  Cricket_Match with following columns and populate it with data given. 
-------------------------------------
       Match Player Score
-------------------------------------	
        1      A      0
	1      B      101
	1      C      55
	1      D      23
	1      E      12
	1      F      100
	2      A      146
	2      B      120
	2      C      104
	2      D      3
	2      E      54
	2      F      111
------------------------------------

  Q) Write query to display players who have scored century in both the games.

  Answer :select  player from Cricket_Match where player in 
	 (select player from Cricket_Match where score>99 and matches= 2) and score>99 and matches=1;



  Q) Write query to display players who have scored century in match 1 OR match 2 but not in both.

  Answer :create view centuries as 
	  select  player from Cricket_Match where player in 
	  (select player from Cricket_Match where score>99 and matches= 2) and score>99 and matches=1;
	  
	  select distinct(player) from Cricket_Match where score>99 and player not in(select * from centuries);



7)  Create a table friend_list(Name, Friend_Name)
Populate it with following data:
        ------------------ 
	Name | Friend_Name 
        ------------------
	Sam      Ram
	Sam      Vamsi
	Vamsi    Ram
	Vamsi    Jhon
	Ram      Vijay
	Ram      Anand

write a query to find friends of friends of sam. 

Desired O/P
-----------------------------
Name, Friend_of_Firend of SAM.
-----------------------------
sam,    ram
sam,    jhon
sam,    vijay
sam,    anand
-----------------------------

Answer: select b.friend_name from friend_list as a , friend_list as b where a.name<>b.name
 	and a.friend_name<>b.friend_name and a.friend_name=b.name and a.name='sam';



8) Create a function to calculate new salary of an employee from hr.employees table by a certain percentage.
   Two IN parameters (Employee_id,Hike_pct) 
   One OUT parameter (New_Salary) 

Answer: delimiter //

	create function newsalary(emp_id int ,hike int) returns int deterministic
	begin
	declare sal int;
	update employees set salary=salary+(salary*hike)/100 where employee_id=emp_id;
	select salary from employees where employee_id=emp_id into sal;
	return sal;
	end 

	//
	delimiter;

	select distinct(newsalary(1,13));



9) Create a stored procedure to update the salary of an employee by 13% in hr.employees table.
   One IN parameter - emp_id 

Answer: delimiter//
 	create procedure updatesalary(emp_id int)
   	begin
   	select (newsalary(emp_id,13)); # use of function declared in previous question
	end//
 	delimiter 
 	call updatesalary1(1);



   *** Use the function created in previous question to calculate new salary. 
  
